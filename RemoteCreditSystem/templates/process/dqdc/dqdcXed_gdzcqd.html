<!DOCTYPE html>
<html lang="zh-cn">
<head>	
	<meta charset="utf-8">
	<title>小微贷款业务管理系统</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Charisma, a fully featured, responsive, HTML5, Bootstrap admin template.">
	<meta name="author" content="Muhammad Usman">

	<!-- The styles -->
	<link href="/static/css/bootstrap_xh.css" rel="stylesheet">
	<link href="/static/css/main_xh.css" rel="stylesheet">
	<link href="/static/css/datepicker.css" rel="stylesheet">
	<style type="text/css">
		input.btn-mini{width:20px;margin-top:0px;}	
		input[type=text]{width:120px;}
	</style>
</head>

<body onload="sub();datepicker();setTimeOut();parent.parent.scroll(0,0);">		
	<form class="content" method="post" action="/Process/dqdc/new_car">	
		{%- with messages = get_flashed_messages(with_categories=true) %}
			{%- if messages %}
			{%- for category, message in messages %}
			<div class="alert alert-{{category}}">
				{{message}}
			</div>
			{%- endfor %}
			{%- endif %}
		{%- endwith %}
		<div class="tabbable">
			<ul class="nav nav-tabs">
				<li class="active"><a href="#tab1" data-toggle="tab" onclick="$('#tab1').attr('class','tab-pane active');$('#tab2').attr('class','tab-pane');$('#tab3').attr('class','tab-pane');doubleIframe('dqdcXed_zcfzb');">房地产详单</a></li>
				<li><a href="#tab2" data-toggle="tab" onclick="$('#tab1').attr('class','tab-pane');$('#tab2').attr('class','tab-pane active');$('#tab3').attr('class','tab-pane');doubleIframe('dqdcXed_zcfzb');">设备及器材详单</a></li>
				<li><a href="#tab3" data-toggle="tab" onclick="$('#tab1').attr('class','tab-pane active');$('#tab2').attr('class','tab-pane');$('#tab3').attr('class','tab-pane active');doubleIframe('dqdcXed_zcfzb');">车辆详单</a></li>
			</ul>						
			<div class="tab-content">
				<!--房地产详单-->
				<div class="tab-pane active" id="tab1">
					<!--*****************************************房地产详单**************************************************-->
					<div id="FDC">
						<i class="icon-bookmark"></i><span class="titletip">房地产详单</span>
						<input type="button" value="+" onclick="addTd('fdcxd','dqdcXed_zcfzb')" class="btn btn-info btn-mini" />
						<input type="button" value="-" onclick="removeTd('fdcxd','dqdcXed_zcfzb');sub()" class="btn btn-info btn-mini" />
						<div class="divBorder">	
							<table class="table-list" cellspacing="10" id="fdcxd">				
								<tr>
									<th>房地产名称</th>         
									<th>购置时间</th>
									<th>原始单价</th>
									<th>折旧率%</th>							
									<th>数量</th>
									<th>总价值</th>							
									<th>折旧后价值</th>
								</tr>
								
								{%- for obj in fixed_assets_estate %}							
								<tr class="center">
									<td>
									<input type='text' name='name' value="{{obj.name}}" onchange='spryMaxLength(this,32)'/><br/>&nbsp;
									<span class='errorInfo'>字符数不得大于32</span>
								</td>
								<td>
									<input type='text' name='purchase_date'  value="{{obj.purchase_date}}" class='datepicker' data-date-format='yyyy-mm-dd' readonly/><br/>&nbsp;
								</td>								        
								<td>
									<input type='text' name='purchase_price'  value="{{obj.purchase_price}}" maxlength='11' onclick="setJe(this)" onkeyup="setJe(this)" onblur="zjz(this,'purchase_price','total','total_price');zjl(this,'total_price','rate','rate_price');sub()"/>
									<br/><span class='je'>人民币</span>
									<span class='errorInfo'></span>
								</td>
								<td>
									<input type='text' name='rate'  value="{{obj.rate}}" onchange="check(this,1,100)" onblur="zjl(this,'total_price','rate','rate_price');sub()" onkeyup="checkNUM(this)" style='width:40px'/>%
									<br/>&nbsp;<span class='errorInfo'>请输入1-100的有效数字</span>
								</td>
								<td>
									<input type='text' name='total'  value="{{obj.total}}" onkeyup='checkNUM(this)' maxlength='10' onblur="zjz(this,'purchase_price','total','total_price');zjl(this,'total_price','rate','rate_price');sub()"/><br/>&nbsp;
								</td>
								<td>
									<input type='text' name='total_price'  value="{{obj.total_price}}" class='subData1' onclick="setJe(this)" readonly/>
									<br/><span class='je'>人民币</span>
									<span class='errorInfo'></span>
								</td>
								<td>
									<input type='text' class='subData2'  value="{{obj.rate_price}}" name='rate_price' onclick='setJe(this)' onblur='sub()'/>
									<br/><span class='je'>人民币</span>
									<span class='errorInfo'></span>
									<input type="hidden" name="mode" value="1"/>
								</td>		
								</tr>	
								{%- endfor %}								
							</table>
							<table id="kcxx" class="table-list">
								<tr>
									<th style="border-top:none;">
										<b>合计</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;						
										总价值:<span id="sub1"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
										折旧后价值:<span id="sub2"></span>
									</th>
								</tr>		
							</table>
						</div>
						
					</div>
				</div><!--/房地产详单-->

				<!--设备及器材详单-->
				<div class="tab-pane" id="tab2">								
					<!--*****************************************设备及器材详单**************************************************-->
					<div id="SBXD">
						<i class="icon-bookmark"></i><span class="titletip">设备及器材详单</span>
						<input type="button" value="+" id="add2" onclick="addTd('sbjqcxd','dqdcXed_zcfzb')" class="btn btn-info btn-mini" />
						<input type="button" value="-" id="cut2" onclick="removeTd('sbjqcxd','dqdcXed_zcfzb');sub()" class="btn btn-info btn-mini" />
						<div class="divBorder">	
							<table class="table-list" cellspacing="10" id="sbjqcxd">
								<tr>
									<th>设备及器材名称</th>
									<th>购置时间</th>
									<th>原始单价</th>
									<th>折旧率%</th>	
									<th>数量</th>		
									<th>总价值</th>
									<th>折旧后价值</th>							
								</tr>								
								{%- for obj in fixed_assets_equipment %}							
								<tr class="center">
									<td>
									<input type='text' name='name' value="{{obj.name}}" onchange='spryMaxLength(this,32)'/><br/>&nbsp;
									<span class='errorInfo'>字符数不得大于32</span>
								</td>
								<td>
									<input type='text' name='purchase_date'  value="{{obj.purchase_date}}" class='datepicker' data-date-format='yyyy-mm-dd' readonly/><br/>&nbsp;
								</td>								        
								<td>
									<input type='text' name='purchase_price'  value="{{obj.purchase_price}}" maxlength='11' onclick="setJe(this)" onkeyup="setJe(this)" onblur="zjz(this,'purchase_price','total','total_price');zjl(this,'total_price','rate','rate_price');sub()"/>
									<br/><span class='je'>人民币</span>
									<span class='errorInfo'></span>
								</td>
								<td>
									<input type='text' name='rate'  value="{{obj.rate}}" onchange="check(this,1,100)" onblur="zjl(this,'total_price','rate','rate_price');sub()" onkeyup="checkNUM(this)" style='width:40px'/>%
									<br/>&nbsp;<span class='errorInfo'>请输入1-100的有效数字</span>
								</td>
								<td>
									<input type='text' name='total'  value="{{obj.total}}" onkeyup='checkNUM(this)' maxlength='10' onblur="zjz(this,'purchase_price','total','total_price');zjl(this,'total_price','rate','rate_price');sub()"/><br/>&nbsp;
								</td>
								<td>
									<input type='text' name='total_price'  value="{{obj.total_price}}" class='subData3' onclick="setJe(this)" readonly/>
									<br/><span class='je'>人民币</span>
									<span class='errorInfo'></span>
								</td>
								<td>
									<input type='text' class='subData4'  value="{{obj.rate_price}}" name='rate_price' onclick='setJe(this)' onblur='sub()'/>
									<br/><span class='je'>人民币</span>
									<span class='errorInfo'></span>
									<input type="hidden" name="mode" value="2"/>
								</td>		
								</tr>	
								{%- endfor %}															
							</table>
							<table id="kcxx" class="table-list">
								<tr>
									<th style="border-top:none;">
										<b>合计</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;						
										总价值:<span id="sub3"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
										折旧后价值:<span id="sub4"></span>
									</th>
								</tr>		
							</table>
						</div>
									
					</div>
				</div><!--设备及器材详单-->		

				<!--车辆详单-->
				<div class="tab-pane" id="tab3">								
					<!--*****************************************车辆详单**************************************************-->
					<div id="CLXD"> 
						<i class="icon-bookmark"></i><span class="titletip">车辆详单</span>
						<input type="button" value="+" onclick="addTd('clxd','dqdcXed_zcfzb')" class="btn btn-info btn-mini" />
						<input type="button" value="-" onclick="removeTd('clxd','dqdcXed_zcfzb');sub()" class="btn btn-info btn-mini" />
						<div class="divBorder">	
							<table class="table-list" cellspacing="10" id="clxd">
								<tr>
									<th>车辆</th> 
									<th>购置时间</th>
									<th>原始单价</th>
									<th>折旧率%</th>
									<th>数量</th>
									<th>总价值</th>			
									<th>折旧后价值</th>
								</tr>	
								{%- for obj in fixed_assets_car %}							
								<tr class="center">
									<td>
									<input type='text' name='name' value="{{obj.name}}" onchange='spryMaxLength(this,32)'/><br/>&nbsp;
									<span class='errorInfo'>字符数不得大于32</span>
								</td>
								<td>
									<input type='text' name='purchase_date'  value="{{obj.purchase_date}}" class='datepicker' data-date-format='yyyy-mm-dd' readonly/><br/>&nbsp;
								</td>								        
								<td>
									<input type='text' name='purchase_price'  value="{{obj.purchase_price}}" maxlength='11' onclick="setJe(this)" onkeyup="setJe(this)" onblur="zjz(this,'purchase_price','total','total_price');zjl(this,'total_price','rate','rate_price');sub()"/>
									<br/><span class='je'>人民币</span>
									<span class='errorInfo'></span>
								</td>
								<td>
									<input type='text' name='rate'  value="{{obj.rate}}" onchange="check(this,1,100)" onblur="zjl(this,'total_price','rate','rate_price');sub()" onkeyup="checkNUM(this)" style='width:40px'/>%
									<br/>&nbsp;<span class='errorInfo'>请输入1-100的有效数字</span>
								</td>
								<td>
									<input type='text' name='total'  value="{{obj.total}}" onkeyup='checkNUM(this)' maxlength='10' onblur="zjz(this,'purchase_price','total','total_price');zjl(this,'total_price','rate','rate_price');sub()"/><br/>&nbsp;
								</td>
								<td>
									<input type='text' name='total_price'  value="{{obj.total_price}}" class='subData5' onclick="setJe(this)" readonly/>
									<br/><span class='je'>人民币</span>
									<span class='errorInfo'></span>
								</td>
								<td>
									<input type='text' class='subData6'  value="{{obj.rate_price}}" name='rate_price' onclick='setJe(this)' onblur='sub()'/>
									<br/><span class='je'>人民币</span>
									<span class='errorInfo'></span>
									<input type="hidden" name="mode" value="3"/>
								</td>		
								</tr>	
								{%- endfor %}							
							</table>
							<table id="kcxx" class="table-list">
								<tr>
									<th style="border-top:none;">
										<b>合计</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;						
										总价值:<span id="sub5"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
										折旧后价值:<span id="sub6"></span>
									</th>
								</tr>		
							</table>
						</div>
						<input name="hiddenId" type="hidden" value="{{id}}"/>
						
					</div>
				</div><!--车辆详单-->						
			</div><!-- tabContent -->
		</div>
		<!-- <input type="submit" value="提交" class="btn btn-info"/> -->
	</form>

	<script src="/static/js/jquery-1.7.2.min.js"></script>
	<script src="/static/js/bootstrap.min.js"></script>
	<script src="/static/js/bootstrap-datepicker.js"></script>
	<script src="/static/js/script.js"></script>
	<script src="/static/js/process.js"></script>
	<script type="text/javascript">		
		var max=0;
		var jegs=0;
		var num=0;
		var idCard=0;
		var phone=0;
		function sub(){
			//var num=$(".tbData").length;			
			//$("#sub1").text("总笔数："+num);
			for(i=1;i<7;i++){
				var sum=0;	
				if($(".subData"+i).length==0){
					if(i==1)
						$("#sub"+i).html(0); 
					else
						$("#sub"+i).html(0+"（<span class='je'>"+hjje($("#sub"+i),0)+"</span>）"); 	
				}					
				else{
					$.each($(".subData"+i),function(){ 
						if(this.value=="")
							sum=sum;
						else
							sum += parseFloat(this.value);
						$("#sub"+i).html(sum+"（<span class='je'>"+hjje($("#sub"+i),sum)+"</span>）"); 	
					}); 
				}
			}
		}
		function zjz(obj,name1,name2,sumname){
			var sum=0;
			var a=$(obj).parent().parent().find("input[name="+name1+"]").val();//
			var b=$(obj).parent().parent().find("input[name="+name2+"]").val();//
			if(a==""){a=0;}
			else{a=parseFloat(a);}
			if(b==""){b=0;}
			else{b=parseFloat(b);}
			sum=a*b;
			$(obj).parent().parent().find("input[name="+sumname+"]").val(sum);//
			$(obj).parent().parent().find("input[name="+sumname+"]").click();
		}
		function zjl(obj,name1,name2,sumname){
			var sum=0;
			var a=$(obj).parent().parent().find("input[name="+name1+"]").val();
			var b=$(obj).parent().parent().find("input[name="+name2+"]").val();
			if(a==""){a=0;}
			else{a=parseFloat(a);}
			if(b==""){b=0;}
			else{b=parseFloat(b)/100;}
			sum=a*b;
			$(obj).parent().parent().find("input[name="+sumname+"]").val(sum);
			$(obj).parent().parent().find("input[name="+sumname+"]").click();
		}
	</script>
</form>
</body>
</html>
